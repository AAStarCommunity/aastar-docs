import{_ as e,c as s,o as a,ag as i}from"./chunks/framework.dvv-DFtf.js";const p=JSON.parse('{"title":"L3 SDK Refinement & Gap Analysis","description":"","frontmatter":{},"headers":[],"relativePath":"guide/docs/L3_Use_Case_Analysis.md","filePath":"guide/docs/L3_Use_Case_Analysis.md","lastUpdated":1769959258000}'),n={name:"guide/docs/L3_Use_Case_Analysis.md"};function l(r,t,o,d,c,g){return a(),s("div",null,[...t[0]||(t[0]=[i(`<h1 id="l3-sdk-refinement-gap-analysis" tabindex="-1">L3 SDK Refinement &amp; Gap Analysis <a class="header-anchor" href="#l3-sdk-refinement-gap-analysis" aria-label="Permalink to &quot;L3 SDK Refinement &amp; Gap Analysis&quot;">‚Äã</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">‚Äã</a></h2><p>This document analyzes the current state of the L3 SDK against the &quot;Complete Lifecycle Patterns Design&quot; requirements. It identifies gaps, proposes architectural refinements, and outlines a prioritized implementation roadmap.</p><h2 id="_1-gap-analysis-current-vs-target" tabindex="-1">1. Gap Analysis: Current vs. Target <a class="header-anchor" href="#_1-gap-analysis-current-vs-target" aria-label="Permalink to &quot;1. Gap Analysis: Current vs. Target&quot;">‚Äã</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">Role / Pattern</th><th style="text-align:left;">Current State (<code>USER_CASE_DESIGN.md</code>)</th><th style="text-align:left;">Target State (&quot;Complete Lifecycle&quot;)</th><th style="text-align:left;">Status</th><th style="text-align:left;">Priority</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>End User</strong></td><td style="text-align:left;">Focus on Mint SBT &amp; Gasless TX. Basic client.</td><td style="text-align:left;"><strong>Complete Lifecycle</strong>: Register -&gt; Gasless -&gt; Reputation -&gt; Exit. Query capabilities.</td><td style="text-align:left;">üîÑ Partial</td><td style="text-align:left;"><strong>P0</strong></td></tr><tr><td style="text-align:left;"><strong>Community Admin</strong></td><td style="text-align:left;"><code>CommunityLaunchpad</code> exists.</td><td style="text-align:left;"><strong>Governance &amp; Exit</strong>: Transfer to Multisig, Reputation Rules management.</td><td style="text-align:left;">üîÑ Partial</td><td style="text-align:left;"><strong>P0</strong></td></tr><tr><td style="text-align:left;"><strong>Paymaster Operator</strong></td><td style="text-align:left;"><code>OperatorLifecycle</code> covers setup.</td><td style="text-align:left;"><strong>Exit Strategy</strong>: Withdraw funds, initiate exit. Dynamic config.</td><td style="text-align:left;">üîÑ Partial</td><td style="text-align:left;"><strong>P0</strong></td></tr><tr><td style="text-align:left;"><strong>SuperPaymaster Operator</strong></td><td style="text-align:left;">Basic client exists (V4).</td><td style="text-align:left;"><strong>Dedicated Manager</strong>: Register, Treasury config, liquidity management.</td><td style="text-align:left;">‚ùå Missing</td><td style="text-align:left;"><strong>P1</strong></td></tr><tr><td style="text-align:left;"><strong>Protocol Admin</strong></td><td style="text-align:left;">Basic scripts.</td><td style="text-align:left;"><strong>Governance</strong>: Global param updates, DAO transfer.</td><td style="text-align:left;">‚ùå Missing</td><td style="text-align:left;"><strong>P1</strong></td></tr><tr><td style="text-align:left;"><strong>DVT Operator</strong></td><td style="text-align:left;">Placeholder in scripts.</td><td style="text-align:left;"><strong>Node Manager</strong>: BLS Key gen, validator set management.</td><td style="text-align:left;">‚ùå Missing</td><td style="text-align:left;"><strong>P2</strong></td></tr><tr><td style="text-align:left;"><strong>Reputation Manager</strong></td><td style="text-align:left;">Basic scoreboard.</td><td style="text-align:left;"><strong>Rule Engine</strong>: Dynamic rule configuration &amp; scoring.</td><td style="text-align:left;">‚ùå Missing</td><td style="text-align:left;"><strong>P2</strong></td></tr></tbody></table><h2 id="_2-architectural-refinements" tabindex="-1">2. Architectural Refinements <a class="header-anchor" href="#_2-architectural-refinements" aria-label="Permalink to &quot;2. Architectural Refinements&quot;">‚Äã</a></h2><h3 id="_2-1-unified-lifecycle-pattern" tabindex="-1">2.1 Unified Lifecycle Pattern <a class="header-anchor" href="#_2-1-unified-lifecycle-pattern" aria-label="Permalink to &quot;2.1 Unified Lifecycle Pattern&quot;">‚Äã</a></h3><p>Move from ad-hoc &quot;Client&quot; classes to structured &quot;Lifecycle&quot; patterns.</p><ul><li><strong>Old</strong>: <code>UserClient</code> mixed basic wallet ops with business logic.</li><li><strong>New</strong>: <code>UserLifecycle</code> extends <code>UserClient</code> patterns but strictly follows <code>onboard</code> -&gt; <code>operate</code> -&gt; <code>exit</code> flow.</li></ul><h3 id="_2-2-gasless-first-design" tabindex="-1">2.2 Gasless-First Design <a class="header-anchor" href="#_2-2-gasless-first-design" aria-label="Permalink to &quot;2.2 Gasless-First Design&quot;">‚Äã</a></h3><p>Gasless should be a configuration option, not a separate class.</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GaslessConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  paymasterUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;CREDIT&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;TOKEN&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;SPONSORED&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><strong>Implementation</strong>: All Lifecycle classes (User, Operator) accept <code>GaslessConfig</code> in constructor.</li><li><strong>Middlestream</strong>: Use <code>PaymasterClient</code> middleware automatically if config is present.</li></ul><h3 id="_2-3-strict-typing" tabindex="-1">2.3 Strict Typing <a class="header-anchor" href="#_2-3-strict-typing" aria-label="Permalink to &quot;2.3 Strict Typing&quot;">‚Äã</a></h3><p>Enforce return types (e.g., <code>Promise&lt;Hash&gt;</code>, <code>Promise&lt;OnboardResult&gt;</code>) to standardize API responses for frontend consumers.</p><h2 id="_3-detailed-refinement-plan-p0-priorities" tabindex="-1">3. Detailed Refinement Plan (P0 Priorities) <a class="header-anchor" href="#_3-detailed-refinement-plan-p0-priorities" aria-label="Permalink to &quot;3. Detailed Refinement Plan (P0 Priorities)&quot;">‚Äã</a></h2><h3 id="_3-1-userlifecycle-the-all-in-one-user" tabindex="-1">3.1 UserLifecycle (The &quot;All-in-One&quot; User) <a class="header-anchor" href="#_3-1-userlifecycle-the-all-in-one-user" aria-label="Permalink to &quot;3.1 UserLifecycle (The &quot;All-in-One&quot; User)&quot;">‚Äã</a></h3><ul><li><strong>Goal</strong>: Consolidate <code>EndUserClient</code> and disjoint scripts into one clean class.</li><li><strong>Key Methods</strong>: <ul><li><code>onboard(community, stakeAmount)</code>: Wraps Approve GToken -&gt; Stake -&gt; Mint SBT.</li><li><code>enableGasless(config)</code>: Activates smart account features.</li><li><code>leaveCommunity()</code>: Handles unstaking and SBT burning.</li></ul></li></ul><h3 id="_3-2-operatorlifecycle-enhanced" tabindex="-1">3.2 OperatorLifecycle (Enhanced) <a class="header-anchor" href="#_3-2-operatorlifecycle-enhanced" aria-label="Permalink to &quot;3.2 OperatorLifecycle (Enhanced)&quot;">‚Äã</a></h3><ul><li><strong>Goal</strong>: Add missing &quot;Exit&quot; capabilities to existing logic.</li><li><strong>Updates</strong>: <ul><li>Add <code>withdrawAllFunds()</code>: Sweeps ETH and GTokens.</li><li>Add <code>initiateExit()</code>: Formal unstake process from Registry.</li></ul></li></ul><h3 id="_3-3-protocolgovernance-new-core" tabindex="-1">3.3 ProtocolGovernance (New Core) <a class="header-anchor" href="#_3-3-protocolgovernance-new-core" aria-label="Permalink to &quot;3.3 ProtocolGovernance (New Core)&quot;">‚Äã</a></h3><ul><li><strong>Goal</strong>: Centralize admin functions currently scattered in scripts.</li><li><strong>Key Methods</strong>: <ul><li><code>setGlobalParameters()</code></li><li><code>transferToDAO()</code></li></ul></li></ul><h2 id="_4-documentation-strategy" tabindex="-1">4. Documentation Strategy <a class="header-anchor" href="#_4-documentation-strategy" aria-label="Permalink to &quot;4. Documentation Strategy&quot;">‚Äã</a></h2><ul><li><strong>One Doc Per Pattern</strong>: Create dedicated <code>.md</code> files for each Lifecycle pattern in <code>docs/l3-patterns/</code>.</li><li><strong>Scenario-Driven</strong>: Docs should lead with &quot;How to [Scenario]&quot; rather than method lists.</li></ul><h2 id="_5-next-steps" tabindex="-1">5. Next Steps <a class="header-anchor" href="#_5-next-steps" aria-label="Permalink to &quot;5. Next Steps&quot;">‚Äã</a></h2><ol><li><strong>Refactor</strong>: Create <code>UserLifecycle.ts</code> implementing the new design.</li><li><strong>Enhance</strong>: Update <code>OperatorLifecycle.ts</code> with exit methods.</li><li><strong>Create</strong>: Implement <code>ProtocolGovernance.ts</code>.</li><li><strong>Verify</strong>: Build <code>examples/l3-complete-demo.ts</code> to test the full flow.</li></ol>`,26)])])}const u=e(n,[["render",l]]);export{p as __pageData,u as default};
